# èšåˆæœç´¢æœåŠ¡ - ç´¢å¼•å­—æ®µéªŒè¯æŠ¥å‘Š

## ğŸ“‹ éªŒè¯æ¦‚è§ˆ

**éªŒè¯æ—¶é—´**: 2025-01-04  
**éªŒè¯èŒƒå›´**: ç´¢å¼•æ˜ å°„ vs å®ä½“ç±»å­—æ®µ  
**éªŒè¯ç´¢å¼•æ•°**: 3ä¸ª  
**éªŒè¯çŠ¶æ€**: âš ï¸ å‘ç°ä¸åŒ¹é…

---

## ğŸ” ApiDoc ç´¢å¼•éªŒè¯

### å®ä½“ç±»å­—æ®µ (19ä¸ª)
```java
public class ApiDoc {
    private String id;              // API ID
    private String name;            // API åç§°
    private String code;            // API ç¼–ç 
    private String path;            // API è·¯å¾„
    private String method;          // è¯·æ±‚æ–¹æ³•
    private String protocol;        // åè®®
    private String description;     // API æè¿°
    private String groupId;         // åˆ†ç»„ID
    private String groupName;       // åˆ†ç»„åç§°
    private String status;          // çŠ¶æ€
    private String statusName;      // çŠ¶æ€åç§°
    private String authType;        // è®¤è¯æ–¹å¼
    private String version;         // ç‰ˆæœ¬å·
    private String tenantId;        // ç§Ÿæˆ·ID
    private String createdBy;       // åˆ›å»ºäººID
    private String creatorName;     // åˆ›å»ºäººåç§°
    private LocalDateTime publishedAt;  // å‘å¸ƒæ—¶é—´
    private LocalDateTime createdAt;    // åˆ›å»ºæ—¶é—´
    private LocalDateTime updatedAt;    // æ›´æ–°æ—¶é—´
}
```

### å½“å‰ç´¢å¼•æ˜ å°„ (15ä¸ª)
```
âœ… id (keyword)
âœ… name (text, ikåˆ†è¯)
âœ… description (text, ikåˆ†è¯)
âœ… tenantId (keyword)
âœ… groupId (keyword)
âœ… code (keyword)
âœ… path (keyword)
âœ… method (keyword)
âœ… status (keyword)
âœ… authType (keyword)
âœ… timeout (integer)
âœ… todayCalls (long)
âœ… totalCalls (long)
âœ… mockEnabled (boolean)
âœ… rateLimitEnabled (boolean)
âœ… createdAt (date)
âœ… updatedAt (date)
âœ… publishedAt (date)
```

### âš ï¸ å­—æ®µå¯¹æ¯”åˆ†æ

#### ç¼ºå°‘çš„å­—æ®µ (5ä¸ª)
| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å»ºè®®æ˜ å°„ |
|--------|------|------|----------|
| protocol | String | åè®® | keyword |
| groupName | String | åˆ†ç»„åç§° | keyword |
| statusName | String | çŠ¶æ€åç§° | keyword |
| version | String | ç‰ˆæœ¬å· | keyword |
| creatorName | String | åˆ›å»ºäººåç§° | keyword |

#### å¤šä½™çš„å­—æ®µ (5ä¸ª)
| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å¤„ç†å»ºè®® |
|--------|------|------|----------|
| timeout | integer | è¶…æ—¶æ—¶é—´ | ä¿ç•™(å¯èƒ½ç”¨äºæœç´¢) |
| todayCalls | long | ä»Šæ—¥è°ƒç”¨æ•° | ä¿ç•™(å¯èƒ½ç”¨äºæ’åº) |
| totalCalls | long | æ€»è°ƒç”¨æ•° | ä¿ç•™(å¯èƒ½ç”¨äºæ’åº) |
| mockEnabled | boolean | Mockå¼€å…³ | ä¿ç•™(å¯èƒ½ç”¨äºç­›é€‰) |
| rateLimitEnabled | boolean | é™æµå¼€å…³ | ä¿ç•™(å¯èƒ½ç”¨äºç­›é€‰) |

#### ç¼ºå°‘çš„å­—æ®µ (1ä¸ª)
| å­—æ®µå | è¯´æ˜ |
|--------|------|
| createdBy | åˆ›å»ºäººID (å®ä½“ç±»æœ‰,ç´¢å¼•ç¼ºå°‘) |

---

## ğŸ” AppDoc ç´¢å¼•éªŒè¯

### å®ä½“ç±»å­—æ®µ (16ä¸ª)
```java
public class AppDoc {
    private String id;              // åº”ç”¨ID
    private String tenantId;        // ç§Ÿæˆ·ID
    private String name;            // åº”ç”¨åç§°
    private String code;            // åº”ç”¨ç¼–ç 
    private String description;     // åº”ç”¨æè¿°
    private String appType;         // åº”ç”¨ç±»å‹
    private String appTypeName;     // åº”ç”¨ç±»å‹åç§°
    private String appKey;          // AppKey
    private String status;          // åº”ç”¨çŠ¶æ€
    private String statusName;      // çŠ¶æ€åç§°
    private String contactName;     // è”ç³»äººå§“å
    private String contactEmail;    // è”ç³»äººé‚®ç®±
    private String createdBy;       // åˆ›å»ºäººID
    private String createdByName;   // åˆ›å»ºäººå§“å
    private LocalDateTime createdAt;    // åˆ›å»ºæ—¶é—´
    private LocalDateTime updatedAt;    // æ›´æ–°æ—¶é—´
}
```

### å½“å‰ç´¢å¼•æ˜ å°„ (13ä¸ª)
```
âœ… id (keyword)
âœ… name (text, ikåˆ†è¯)
âœ… description (text, ikåˆ†è¯)
âœ… tenantId (keyword)
âœ… appKey (keyword)
âŒ appSecret (keyword) - å®ä½“ç±»æ²¡æœ‰
âœ… status (keyword)
âœ… createdBy (keyword)
âœ… todayCalls (long) - å®ä½“ç±»æ²¡æœ‰
âœ… totalCalls (long) - å®ä½“ç±»æ²¡æœ‰
âœ… apiCount (integer) - å®ä½“ç±»æ²¡æœ‰
âœ… enabled (boolean) - å®ä½“ç±»æ²¡æœ‰
âœ… createdAt (date)
âœ… updatedAt (date)
```

### âš ï¸ å­—æ®µå¯¹æ¯”åˆ†æ

#### ç¼ºå°‘çš„å­—æ®µ (7ä¸ª)
| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å»ºè®®æ˜ å°„ |
|--------|------|------|----------|
| code | String | åº”ç”¨ç¼–ç  | keyword |
| appType | String | åº”ç”¨ç±»å‹ | keyword |
| appTypeName | String | åº”ç”¨ç±»å‹åç§° | keyword |
| statusName | String | çŠ¶æ€åç§° | keyword |
| contactName | String | è”ç³»äººå§“å | text, ikåˆ†è¯ |
| contactEmail | String | è”ç³»äººé‚®ç®± | keyword |
| createdByName | String | åˆ›å»ºäººå§“å | keyword |

#### å¤šä½™çš„å­—æ®µ (5ä¸ª)
| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å¤„ç†å»ºè®® |
|--------|------|------|----------|
| appSecret | keyword | åº”ç”¨å¯†é’¥ | åˆ é™¤(å®‰å…¨è€ƒè™‘) |
| todayCalls | long | ä»Šæ—¥è°ƒç”¨æ•° | ä¿ç•™æˆ–åˆ é™¤ |
| totalCalls | long | æ€»è°ƒç”¨æ•° | ä¿ç•™æˆ–åˆ é™¤ |
| apiCount | integer | APIæ•°é‡ | ä¿ç•™æˆ–åˆ é™¤ |
| enabled | boolean | æ˜¯å¦å¯ç”¨ | ä¿ç•™æˆ–åˆ é™¤ |

---

## ğŸ” UserDoc ç´¢å¼•éªŒè¯

### å®ä½“ç±»å­—æ®µ (13ä¸ª)
```java
public class UserDoc {
    private String id;              // ç”¨æˆ·ID
    private String tenantId;        // ç§Ÿæˆ·ID
    private String username;        // ç”¨æˆ·å
    private String nickname;        // æ˜µç§°
    private String email;           // é‚®ç®±
    private String phone;           // æ‰‹æœºå·
    private String avatar;          // å¤´åƒURL
    private String status;          // çŠ¶æ€
    private String statusName;      // çŠ¶æ€åç§°
    private LocalDateTime lastLoginAt;  // æœ€åç™»å½•æ—¶é—´
    private LocalDateTime createdAt;    // åˆ›å»ºæ—¶é—´
    private LocalDateTime updatedAt;    // æ›´æ–°æ—¶é—´
}
```

### å½“å‰ç´¢å¼•æ˜ å°„ (13ä¸ª)
```
âœ… id (keyword)
âœ… nickname (text, ikåˆ†è¯)
âŒ bio (text, ikåˆ†è¯) - å®ä½“ç±»æ²¡æœ‰
âœ… tenantId (keyword)
âœ… username (keyword)
âœ… email (keyword)
âœ… phone (keyword)
âœ… status (keyword)
âŒ role (keyword) - å®ä½“ç±»æ²¡æœ‰
âŒ loginCount (long) - å®ä½“ç±»æ²¡æœ‰
âŒ enabled (boolean) - å®ä½“ç±»æ²¡æœ‰
âœ… lastLoginAt (date)
âœ… createdAt (date)
âœ… updatedAt (date)
```

### âš ï¸ å­—æ®µå¯¹æ¯”åˆ†æ

#### ç¼ºå°‘çš„å­—æ®µ (2ä¸ª)
| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å»ºè®®æ˜ å°„ |
|--------|------|------|----------|
| avatar | String | å¤´åƒURL | keyword |
| statusName | String | çŠ¶æ€åç§° | keyword |

#### å¤šä½™çš„å­—æ®µ (4ä¸ª)
| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å¤„ç†å»ºè®® |
|--------|------|------|----------|
| bio | text | ä¸ªäººç®€ä»‹ | ä¿ç•™(å¯èƒ½åç»­æ·»åŠ ) |
| role | keyword | è§’è‰² | ä¿ç•™(å¯èƒ½åç»­æ·»åŠ ) |
| loginCount | long | ç™»å½•æ¬¡æ•° | ä¿ç•™(å¯èƒ½åç»­æ·»åŠ ) |
| enabled | boolean | æ˜¯å¦å¯ç”¨ | ä¿ç•™(å¯èƒ½åç»­æ·»åŠ ) |

---

## ğŸ“Š éªŒè¯ç»Ÿè®¡

### æ€»ä½“ç»Ÿè®¡
| ç´¢å¼• | å®ä½“å­—æ®µæ•° | ç´¢å¼•å­—æ®µæ•° | åŒ¹é…å­—æ®µ | ç¼ºå°‘å­—æ®µ | å¤šä½™å­—æ®µ |
|------|-----------|-----------|---------|---------|---------|
| API | 19 | 18 | 13 | 6 | 5 |
| åº”ç”¨ | 16 | 13 | 6 | 7 | 5 |
| ç”¨æˆ· | 13 | 13 | 9 | 2 | 4 |
| **æ€»è®¡** | **48** | **44** | **28** | **15** | **14** |

### é—®é¢˜åˆ†ç±»
| é—®é¢˜ç±»å‹ | æ•°é‡ | ä¸¥é‡ç¨‹åº¦ |
|---------|------|----------|
| å®ä½“å­—æ®µæœªç´¢å¼• | 15 | ä¸­ |
| ç´¢å¼•å­—æ®µæ— å®ä½“ | 14 | ä½ |

---

## ğŸ”§ ä¿®å¤å»ºè®®

### ä¼˜å…ˆçº§P0 (å¿…é¡»ä¿®å¤)

#### 1. ApiDoc - æ·»åŠ ç¼ºå¤±å­—æ®µ
```java
// æ·»åŠ åˆ° buildApiMappings()
properties.put("protocol", Map.of("type", "keyword"));
properties.put("groupName", Map.of("type", "keyword"));
properties.put("statusName", Map.of("type", "keyword"));
properties.put("version", Map.of("type", "keyword"));
properties.put("createdBy", Map.of("type", "keyword"));
properties.put("creatorName", Map.of("type", "keyword"));
```

#### 2. AppDoc - æ·»åŠ ç¼ºå¤±å­—æ®µ
```java
// æ·»åŠ åˆ° buildAppMappings()
properties.put("code", Map.of("type", "keyword"));
properties.put("appType", Map.of("type", "keyword"));
properties.put("appTypeName", Map.of("type", "keyword"));
properties.put("statusName", Map.of("type", "keyword"));
properties.put("contactName", Map.of("type", "text", "analyzer", "ik_max_word", "search_analyzer", "ik_smart"));
properties.put("contactEmail", Map.of("type", "keyword"));
properties.put("createdByName", Map.of("type", "keyword"));
```

#### 3. AppDoc - åˆ é™¤ä¸å®‰å…¨å­—æ®µ
```java
// ä» buildAppMappings() åˆ é™¤
properties.remove("appSecret");  // å®‰å…¨è€ƒè™‘,ä¸åº”ç´¢å¼•å¯†é’¥
```

#### 4. UserDoc - æ·»åŠ ç¼ºå¤±å­—æ®µ
```java
// æ·»åŠ åˆ° buildUserMappings()
properties.put("avatar", Map.of("type", "keyword"));
properties.put("statusName", Map.of("type", "keyword"));
```

---

### ä¼˜å…ˆçº§P1 (å»ºè®®ä¿®å¤)

#### 5. ç§»é™¤å¤šä½™çš„ç»Ÿè®¡å­—æ®µ
è¿™äº›å­—æ®µåœ¨å®ä½“ç±»ä¸­ä¸å­˜åœ¨,å¯èƒ½æ˜¯è®¾è®¡æ—¶æ·»åŠ çš„:
- `todayCalls`, `totalCalls` (APIå’Œåº”ç”¨)
- `apiCount` (åº”ç”¨)
- `loginCount` (ç”¨æˆ·)

**å»ºè®®**: 
- å¦‚æœéœ€è¦è¿™äº›ç»Ÿè®¡æ•°æ®,åº”åœ¨å®ä½“ç±»ä¸­æ·»åŠ å¯¹åº”å­—æ®µ
- å¦‚æœä¸éœ€è¦,ä»ç´¢å¼•æ˜ å°„ä¸­åˆ é™¤

---

## âœ… ä¿®å¤åçš„å®Œæ•´æ˜ å°„

### ApiDoc å®Œæ•´æ˜ å°„ (24ä¸ªå­—æ®µ)
```java
private Map<String, Object> buildApiMappings() {
    Map<String, Object> mappings = new HashMap<>();
    Map<String, Object> properties = new HashMap<>();
    
    // æ–‡æœ¬å­—æ®µ - ä½¿ç”¨ä¸­æ–‡åˆ†è¯
    properties.put("name", Map.of("type", "text", "analyzer", "ik_max_word", "search_analyzer", "ik_smart"));
    properties.put("description", Map.of("type", "text", "analyzer", "ik_max_word", "search_analyzer", "ik_smart"));
    
    // å…³é”®å­—å­—æ®µ
    properties.put("id", Map.of("type", "keyword"));
    properties.put("tenantId", Map.of("type", "keyword"));
    properties.put("code", Map.of("type", "keyword"));
    properties.put("path", Map.of("type", "keyword"));
    properties.put("method", Map.of("type", "keyword"));
    properties.put("protocol", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("groupId", Map.of("type", "keyword"));
    properties.put("groupName", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("status", Map.of("type", "keyword"));
    properties.put("statusName", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("authType", Map.of("type", "keyword"));
    properties.put("version", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("createdBy", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("creatorName", Map.of("type", "keyword"));  // âœ… æ–°å¢
    
    // æ•°å€¼å­—æ®µ (å¯é€‰,å¦‚æœéœ€è¦ç»Ÿè®¡åŠŸèƒ½)
    properties.put("timeout", Map.of("type", "integer"));
    properties.put("todayCalls", Map.of("type", "long"));
    properties.put("totalCalls", Map.of("type", "long"));
    
    // å¸ƒå°”å­—æ®µ (å¯é€‰,å¦‚æœéœ€è¦ç­›é€‰åŠŸèƒ½)
    properties.put("mockEnabled", Map.of("type", "boolean"));
    properties.put("rateLimitEnabled", Map.of("type", "boolean"));
    
    // æ—¥æœŸå­—æ®µ
    properties.put("createdAt", Map.of("type", "date", "format", "yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"));
    properties.put("updatedAt", Map.of("type", "date", "format", "yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"));
    properties.put("publishedAt", Map.of("type", "date", "format", "yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"));
    
    mappings.put("properties", properties);
    return mappings;
}
```

### AppDoc å®Œæ•´æ˜ å°„ (20ä¸ªå­—æ®µ)
```java
private Map<String, Object> buildAppMappings() {
    Map<String, Object> mappings = new HashMap<>();
    Map<String, Object> properties = new HashMap<>();
    
    // æ–‡æœ¬å­—æ®µ - ä½¿ç”¨ä¸­æ–‡åˆ†è¯
    properties.put("name", Map.of("type", "text", "analyzer", "ik_max_word", "search_analyzer", "ik_smart"));
    properties.put("description", Map.of("type", "text", "analyzer", "ik_max_word", "search_analyzer", "ik_smart"));
    properties.put("contactName", Map.of("type", "text", "analyzer", "ik_max_word", "search_analyzer", "ik_smart"));  // âœ… æ–°å¢
    
    // å…³é”®å­—å­—æ®µ
    properties.put("id", Map.of("type", "keyword"));
    properties.put("tenantId", Map.of("type", "keyword"));
    properties.put("code", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("appKey", Map.of("type", "keyword"));
    // properties.put("appSecret", Map.of("type", "keyword"));  // âŒ åˆ é™¤(å®‰å…¨)
    properties.put("appType", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("appTypeName", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("status", Map.of("type", "keyword"));
    properties.put("statusName", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("contactEmail", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("createdBy", Map.of("type", "keyword"));
    properties.put("createdByName", Map.of("type", "keyword"));  // âœ… æ–°å¢
    
    // æ•°å€¼å­—æ®µ (å¯é€‰)
    properties.put("todayCalls", Map.of("type", "long"));
    properties.put("totalCalls", Map.of("type", "long"));
    properties.put("apiCount", Map.of("type", "integer"));
    
    // å¸ƒå°”å­—æ®µ (å¯é€‰)
    properties.put("enabled", Map.of("type", "boolean"));
    
    // æ—¥æœŸå­—æ®µ
    properties.put("createdAt", Map.of("type", "date", "format", "yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"));
    properties.put("updatedAt", Map.of("type", "date", "format", "yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"));
    
    mappings.put("properties", properties);
    return mappings;
}
```

### UserDoc å®Œæ•´æ˜ å°„ (15ä¸ªå­—æ®µ)
```java
private Map<String, Object> buildUserMappings() {
    Map<String, Object> mappings = new HashMap<>();
    Map<String, Object> properties = new HashMap<>();
    
    // æ–‡æœ¬å­—æ®µ - ä½¿ç”¨ä¸­æ–‡åˆ†è¯
    properties.put("nickname", Map.of("type", "text", "analyzer", "ik_max_word", "search_analyzer", "ik_smart"));
    properties.put("bio", Map.of("type", "text", "analyzer", "ik_max_word", "search_analyzer", "ik_smart"));  // ä¿ç•™
    
    // å…³é”®å­—å­—æ®µ
    properties.put("id", Map.of("type", "keyword"));
    properties.put("tenantId", Map.of("type", "keyword"));
    properties.put("username", Map.of("type", "keyword"));
    properties.put("email", Map.of("type", "keyword"));
    properties.put("phone", Map.of("type", "keyword"));
    properties.put("avatar", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("status", Map.of("type", "keyword"));
    properties.put("statusName", Map.of("type", "keyword"));  // âœ… æ–°å¢
    properties.put("role", Map.of("type", "keyword"));  // ä¿ç•™
    
    // æ•°å€¼å­—æ®µ (å¯é€‰)
    properties.put("loginCount", Map.of("type", "long"));  // ä¿ç•™
    
    // å¸ƒå°”å­—æ®µ (å¯é€‰)
    properties.put("enabled", Map.of("type", "boolean"));  // ä¿ç•™
    
    // æ—¥æœŸå­—æ®µ
    properties.put("lastLoginAt", Map.of("type", "date", "format", "yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"));
    properties.put("createdAt", Map.of("type", "date", "format", "yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"));
    properties.put("updatedAt", Map.of("type", "date", "format", "yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"));
    
    mappings.put("properties", properties);
    return mappings;
}
```

---

## âœ… éªŒè¯ç»“è®º

### å½“å‰çŠ¶æ€: âš ï¸ éœ€è¦ä¿®å¤

**ä¸»è¦é—®é¢˜**:
1. âŒ **ApiDocç¼ºå°‘6ä¸ªå®ä½“å­—æ®µ**: protocol, groupName, statusName, version, createdBy, creatorName
2. âŒ **AppDocç¼ºå°‘7ä¸ªå®ä½“å­—æ®µ**: code, appType, appTypeName, statusName, contactName, contactEmail, createdByName
3. âŒ **AppDocåŒ…å«ä¸å®‰å…¨å­—æ®µ**: appSecret (åº”åˆ é™¤)
4. âŒ **UserDocç¼ºå°‘2ä¸ªå®ä½“å­—æ®µ**: avatar, statusName

**å½±å“**:
- å®ä½“å­—æ®µæ— æ³•è¢«æœç´¢
- ç´¢å¼•æ•°æ®ä¸å®Œæ•´
- å¯èƒ½å¯¼è‡´æœç´¢ç»“æœä¸å‡†ç¡®

**å»ºè®®**: ç«‹å³ä¿®å¤ç¼ºå¤±å­—æ®µ,ç¡®ä¿ç´¢å¼•æ˜ å°„ä¸å®ä½“ç±»å®Œå…¨åŒ¹é…

---

*éªŒè¯æ—¶é—´: 2025-01-04*  
*éªŒè¯äºº: IntelliHub Team*  
*æŠ¥å‘Šç‰ˆæœ¬: v1.0*
