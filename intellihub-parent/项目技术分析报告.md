# IntelliHub é¡¹ç›®æŠ€æœ¯åˆ†ææŠ¥å‘Š

> æœ¬æ–‡æ¡£è¯¦ç»†åˆ†æIntelliHubé¡¹ç›®çš„æŠ€æœ¯é€‰å‹ã€æ ¸å¿ƒä¸šåŠ¡æµç¨‹ã€æ¶æ„è®¾è®¡åŠå­˜åœ¨çš„é—®é¢˜

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯é€‰å‹åˆ†æ](#2-æŠ€æœ¯é€‰å‹åˆ†æ)
3. [ç³»ç»Ÿæ¶æ„è®¾è®¡](#3-ç³»ç»Ÿæ¶æ„è®¾è®¡)
4. [æ ¸å¿ƒä¸šåŠ¡æµç¨‹](#4-æ ¸å¿ƒä¸šåŠ¡æµç¨‹)
5. [å­˜åœ¨çš„é—®é¢˜ä¸é£é™©](#5-å­˜åœ¨çš„é—®é¢˜ä¸é£é™©)
6. [ä¼˜åŒ–å»ºè®®](#6-ä¼˜åŒ–å»ºè®®)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®å®šä½

IntelliHub æ˜¯ä¸€ä¸ªåŸºäºå¾®æœåŠ¡æ¶æ„çš„ **APIå¼€æ”¾å¹³å°**ï¼Œæ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š

- **APIç®¡ç†å¹³å°**ï¼šå…è®¸å†…éƒ¨å¼€å‘è€…æ³¨å†Œã€å‘å¸ƒã€ç®¡ç†APIæ¥å£
- **ç»Ÿä¸€è®¤è¯ä¸­å¿ƒ**ï¼šæä¾›JWTè®¤è¯ã€å¤šç§Ÿæˆ·ã€è§’è‰²æƒé™ç®¡ç†ï¼ˆRBACï¼‰
- **APIç½‘å…³**ï¼šç»Ÿä¸€æµé‡å…¥å£ï¼Œæä¾›è®¤è¯ã€é™æµã€è·¯ç”±è½¬å‘ç­‰èƒ½åŠ›
- **AIGCæœåŠ¡**ï¼šé›†æˆAIèƒ½åŠ›çš„æœåŠ¡æ¨¡å—
- **åº”ç”¨ä¸­å¿ƒ**ï¼šåº”ç”¨ç®¡ç†æœåŠ¡

### 1.2 æ ¸å¿ƒä¸šåŠ¡åœºæ™¯

```mermaid
graph LR
    A[å†…éƒ¨å¼€å‘è€…] -->|æ³¨å†ŒAPI| B[APIç®¡ç†å¹³å°]
    B -->|å‘å¸ƒ| C[å¼€æ”¾å¹³å°ç½‘å…³]
    D[å¤–éƒ¨è°ƒç”¨è€…] -->|API Keyè®¤è¯| C
    C -->|è½¬å‘è¯·æ±‚| E[å†…éƒ¨å¾®æœåŠ¡]
    E -->|å“åº”| C
    C -->|è¿”å›| D
```

### 1.3 é¡¹ç›®æ¨¡å—ç»“æ„

```
intellihub-parent/
â”œâ”€â”€ intelli-common/                  # å…¬å…±ç»„ä»¶æ¨¡å—
â”œâ”€â”€ intelli-gateway-service/         # APIç½‘å…³æœåŠ¡ï¼ˆç«¯å£ï¼š8080ï¼‰
â”œâ”€â”€ intelli-auth-iam-service/        # è®¤è¯æˆæƒæœåŠ¡ï¼ˆç«¯å£ï¼š8081ï¼‰
â”œâ”€â”€ intelli-api-platform-service/    # APIå¹³å°ç®¡ç†æœåŠ¡ï¼ˆç«¯å£ï¼š8082ï¼‰
â”œâ”€â”€ intelli-aigc-service/            # AIGCæœåŠ¡
â”œâ”€â”€ intelli-app-center-service/      # åº”ç”¨ä¸­å¿ƒæœåŠ¡
â”œâ”€â”€ intelli-governance-service/      # æ²»ç†æœåŠ¡
â”œâ”€â”€ intelli-search-service/          # æœç´¢æœåŠ¡
â”œâ”€â”€ intelli-event-service/           # äº‹ä»¶æœåŠ¡
â””â”€â”€ intelli-log-audit-service/       # æ—¥å¿—å®¡è®¡æœåŠ¡
```

---

## 2. æŠ€æœ¯é€‰å‹åˆ†æ

### 2.1 æ ¸å¿ƒæŠ€æœ¯æ ˆ

| æŠ€æœ¯åˆ†ç±» | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬ | è¯´æ˜ |
|---------|---------|------|------|
| **åŸºç¡€æ¡†æ¶** | Spring Boot | 2.7.18 | æ ¸å¿ƒåº”ç”¨æ¡†æ¶ |
| **å¾®æœåŠ¡æ¡†æ¶** | Spring Cloud | 2021.0.9 | å¾®æœåŠ¡æ²»ç† |
| **æœåŠ¡æ²»ç†** | Spring Cloud Alibaba | 2021.0.5.0 | Nacosæ³¨å†Œä¸­å¿ƒ/é…ç½®ä¸­å¿ƒ |
| **APIç½‘å…³** | Spring Cloud Gateway | 2021.0.9 | å“åº”å¼ç½‘å…³ |
| **ORMæ¡†æ¶** | MyBatis Plus | 3.5.5 | æ•°æ®åº“æ“ä½œ |
| **æ•°æ®åº“** | MySQL | 8.0.33 | å…³ç³»å‹æ•°æ®åº“ |
| **ç¼“å­˜** | Redis | - | åˆ†å¸ƒå¼ç¼“å­˜ã€é™æµã€Session |
| **è®¤è¯** | JWT (jjwt) | 0.11.5 | Tokenè®¤è¯ |
| **å¯†ç åŠ å¯†** | BCrypt | - | Spring Securityæä¾› |
| **å·¥å…·åº“** | Hutool | 5.8.22 | Javaå·¥å…·ç±»åº“ |
| **æ–‡æ¡£** | Swagger | 2.0.2 | APIæ–‡æ¡£ |
| **æ„å»ºå·¥å…·** | Maven | - | å¤šæ¨¡å—é¡¹ç›®ç®¡ç† |
| **JDKç‰ˆæœ¬** | JDK 1.8 | - | Javaè¿è¡Œç¯å¢ƒ |

### 2.2 æŠ€æœ¯æ¶æ„å›¾

```mermaid
graph TB
    subgraph å®¢æˆ·ç«¯å±‚
        A1[å‰ç«¯åº”ç”¨]
        A2[å¤–éƒ¨è°ƒç”¨è€…]
    end
    
    subgraph ç½‘å…³å±‚
        B[Spring Cloud Gateway<br/>è®¤è¯/é™æµ/è·¯ç”±]
    end
    
    subgraph æœåŠ¡æ³¨å†Œä¸å‘ç°
        C[Nacos<br/>æœåŠ¡æ³¨å†Œä¸­å¿ƒ]
        D[Nacos<br/>é…ç½®ä¸­å¿ƒ]
    end
    
    subgraph ä¸šåŠ¡æœåŠ¡å±‚
        E1[è®¤è¯æœåŠ¡<br/>IAM]
        E2[APIå¹³å°æœåŠ¡]
        E3[AIGCæœåŠ¡]
        E4[åº”ç”¨ä¸­å¿ƒæœåŠ¡]
        E5[å…¶ä»–æœåŠ¡...]
    end
    
    subgraph æ•°æ®å±‚
        F1[(MySQL)]
        F2[(Redis)]
    end
    
    A1 --> B
    A2 --> B
    B --> C
    B --> D
    B --> E1
    B --> E2
    B --> E3
    B --> E4
    B --> E5
    
    E1 --> F1
    E1 --> F2
    E2 --> F1
    E2 --> F2
    E3 --> F1
    E4 --> F1
    
    E1 -.æ³¨å†Œ.-> C
    E2 -.æ³¨å†Œ.-> C
    E3 -.æ³¨å†Œ.-> C
    E4 -.æ³¨å†Œ.-> C
    
    style B fill:#f9f,stroke:#333,stroke-width:4px
    style C fill:#bbf,stroke:#333,stroke-width:2px
    style D fill:#bbf,stroke:#333,stroke-width:2px
```

### 2.3 æŠ€æœ¯é€‰å‹ä¼˜åŠ¿

âœ… **Spring Cloud Gateway å“åº”å¼ç½‘å…³**
- åŸºäºWebFluxï¼Œæ”¯æŒé«˜å¹¶å‘
- éé˜»å¡I/Oï¼Œæ€§èƒ½ä¼˜äºZuul

âœ… **Nacos æœåŠ¡æ²»ç†**
- æœåŠ¡æ³¨å†Œä¸å‘ç°
- åŠ¨æ€é…ç½®ç®¡ç†
- æ”¯æŒå‘½åç©ºé—´éš”ç¦»

âœ… **MyBatis Plus**
- è‡ªåŠ¨åŒ–CRUDï¼Œå‡å°‘æ ·æ¿ä»£ç 
- å†…ç½®åˆ†é¡µæ’ä»¶
- æ”¯æŒé€»è¾‘åˆ é™¤

âœ… **JWT æ— çŠ¶æ€è®¤è¯**
- æ°´å¹³æ‰©å±•å‹å¥½
- å‡å°‘æœåŠ¡ç«¯å­˜å‚¨å‹åŠ›

---

## 3. ç³»ç»Ÿæ¶æ„è®¾è®¡

### 3.1 å¾®æœåŠ¡æ¶æ„å…¨æ™¯å›¾

```mermaid
graph TB
    subgraph Internet[å…¬ç½‘]
        Client[å¤–éƒ¨å®¢æˆ·ç«¯/è°ƒç”¨è€…]
    end
    
    subgraph DMZ[DMZåŒº]
        Gateway[APIç½‘å…³<br/>:8080<br/>è®¤è¯/é™æµ/è·¯ç”±]
    end
    
    subgraph Internal[å†…ç½‘æœåŠ¡åŒº]
        Auth[è®¤è¯æœåŠ¡<br/>:8081<br/>ç”¨æˆ·/ç§Ÿæˆ·/æƒé™]
        API[APIå¹³å°æœåŠ¡<br/>:8082<br/>APIç®¡ç†/å‘å¸ƒ]
        AIGC[AIGCæœåŠ¡<br/>AIèƒ½åŠ›]
        App[åº”ç”¨ä¸­å¿ƒ<br/>åº”ç”¨ç®¡ç†]
        Gov[æ²»ç†æœåŠ¡<br/>ç›‘æ§/ç†”æ–­]
        Search[æœç´¢æœåŠ¡<br/>å…¨æ–‡æ£€ç´¢]
        Event[äº‹ä»¶æœåŠ¡<br/>æ¶ˆæ¯æ€»çº¿]
        Log[æ—¥å¿—å®¡è®¡<br/>æ“ä½œæ—¥å¿—]
    end
    
    subgraph Storage[å­˜å‚¨å±‚]
        MySQL[(MySQL<br/>ä¸šåŠ¡æ•°æ®)]
        Redis[(Redis<br/>ç¼“å­˜/é™æµ)]
        Nacos[Nacos<br/>æ³¨å†Œä¸­å¿ƒ/é…ç½®ä¸­å¿ƒ]
    end
    
    Client -->|HTTPS| Gateway
    
    Gateway -->|JWTéªŒè¯| Auth
    Gateway -->|è·¯ç”±è½¬å‘| API
    Gateway -->|è·¯ç”±è½¬å‘| AIGC
    Gateway -->|è·¯ç”±è½¬å‘| App
    Gateway -->|è·¯ç”±è½¬å‘| Gov
    Gateway -->|è·¯ç”±è½¬å‘| Search
    Gateway -->|è·¯ç”±è½¬å‘| Event
    Gateway -->|è·¯ç”±è½¬å‘| Log
    
    Auth --> MySQL
    Auth --> Redis
    API --> MySQL
    API --> Redis
    
    Auth -.æœåŠ¡æ³¨å†Œ.-> Nacos
    API -.æœåŠ¡æ³¨å†Œ.-> Nacos
    AIGC -.æœåŠ¡æ³¨å†Œ.-> Nacos
    App -.æœåŠ¡æ³¨å†Œ.-> Nacos
    Gov -.æœåŠ¡æ³¨å†Œ.-> Nacos
    Gateway -.æœåŠ¡å‘ç°.-> Nacos
    
    style Gateway fill:#ff9,stroke:#333,stroke-width:4px
    style Auth fill:#9f9,stroke:#333,stroke-width:2px
    style API fill:#9f9,stroke:#333,stroke-width:2px
```

### 3.2 æ ¸å¿ƒæ¨¡å—è¯´æ˜

#### 3.2.1 intelli-gateway-serviceï¼ˆAPIç½‘å…³ï¼‰

**æ ¸å¿ƒèŒè´£ï¼š**
- ç»Ÿä¸€æµé‡å…¥å£
- JWT Tokenè®¤è¯
- é™æµæ§åˆ¶ï¼ˆåŸºäºRedisæ»‘åŠ¨çª—å£ç®—æ³•ï¼‰
- è·¯ç”±è½¬å‘
- è·¨åŸŸå¤„ç†
- æ—¥å¿—è®°å½•

**å…³é”®è¿‡æ»¤å™¨é“¾ï¼š**
```mermaid
graph LR
    A[è¯·æ±‚] --> B[GlobalLogFilter<br/>è®¿é—®æ—¥å¿—]
    B --> C[ReactiveAuthenticationFilter<br/>JWTè®¤è¯]
    C --> D[RateLimitFilter<br/>é™æµæ§åˆ¶]
    D --> E[GlobalTenantFilter<br/>ç§Ÿæˆ·éš”ç¦»]
    E --> F[è·¯ç”±è½¬å‘]
    F --> G[åç«¯æœåŠ¡]
```

**è·¯ç”±é…ç½®ç¤ºä¾‹ï¼š**
```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: auth-service
          uri: lb://intelli-auth-iam-service
          predicates:
            - Path=/api/auth/**,/api/iam/**
          filters:
            - StripPrefix=1
```

#### 3.2.2 intelli-auth-iam-serviceï¼ˆè®¤è¯æˆæƒæœåŠ¡ï¼‰

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- ç”¨æˆ·ç™»å½•/æ³¨å†Œ
- JWT Tokenç­¾å‘ä¸éªŒè¯
- å¤šç§Ÿæˆ·ç®¡ç†ï¼ˆTenantï¼‰
- è§’è‰²æƒé™ç®¡ç†ï¼ˆRBACï¼‰
- éªŒè¯ç ç”Ÿæˆï¼ˆå›¾å½¢/çŸ­ä¿¡/é‚®ç®±ï¼‰
- å¯†ç åŠ å¯†ï¼ˆBCryptï¼‰

**æ•°æ®æ¨¡å‹ï¼š**
```mermaid
erDiagram
    IamTenant ||--o{ IamUser : contains
    IamUser ||--o{ IamUserRole : has
    IamRole ||--o{ IamUserRole : assigned
    IamRole ||--o{ IamRolePermission : has
    IamPermission ||--o{ IamRolePermission : granted
    
    IamTenant {
        bigint id
        string tenantCode
        string tenantName
        int status
        datetime createdAt
    }
    
    IamUser {
        bigint id
        string tenantId
        string username
        string password
        string email
        string phone
        int status
    }
    
    IamRole {
        bigint id
        string roleCode
        string roleName
        string description
    }
    
    IamPermission {
        bigint id
        string permissionCode
        string permissionName
        string resourceType
    }
```

#### 3.2.3 intelli-api-platform-serviceï¼ˆAPIç®¡ç†å¹³å°ï¼‰

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- APIæ³¨å†Œä¸ç®¡ç†
- APIåˆ†ç»„ç®¡ç†
- APIå‘å¸ƒ/ä¸‹çº¿/åºŸå¼ƒ
- APIç‰ˆæœ¬ç®¡ç†
- APIè°ƒç”¨ç»Ÿè®¡

**APIçŠ¶æ€æµè½¬ï¼š**
```mermaid
stateDiagram-v2
    [*] --> DRAFT: åˆ›å»ºAPI
    DRAFT --> PUBLISHED: å‘å¸ƒ
    PUBLISHED --> OFFLINE: ä¸‹çº¿
    OFFLINE --> PUBLISHED: é‡æ–°å‘å¸ƒ
    PUBLISHED --> DEPRECATED: åºŸå¼ƒ
    DEPRECATED --> [*]
    DRAFT --> [*]: åˆ é™¤
    OFFLINE --> [*]: åˆ é™¤
```

#### 3.2.4 intelli-commonï¼ˆå…¬å…±ç»„ä»¶ï¼‰

**æä¾›çš„èƒ½åŠ›ï¼š**
- ç»Ÿä¸€å“åº”å°è£…ï¼ˆ`ApiResponse`ï¼‰
- ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼ˆ`BusinessException`ï¼‰
- åˆ†é¡µå·¥å…·ï¼ˆ`PageData`ã€`PageWrap`ï¼‰
- å¸¸é‡å®šä¹‰ï¼ˆ`ResponseStatus`ã€`RedisKeyConstants`ï¼‰
- ä¸Šä¸‹æ–‡ç®¡ç†ï¼ˆ`TenantContext`ï¼‰
- æ‹¦æˆªå™¨ï¼ˆ`TenantInterceptor`ï¼‰

---

## 4. æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### 4.1 ç”¨æˆ·è®¤è¯æµç¨‹

```mermaid
sequenceDiagram
    participant Client as å‰ç«¯å®¢æˆ·ç«¯
    participant Gateway as APIç½‘å…³
    participant Auth as è®¤è¯æœåŠ¡
    participant Redis as Redisç¼“å­˜
    participant MySQL as MySQLæ•°æ®åº“
    
    Client->>Gateway: POST /api/iam/v1/auth/login<br/>{username, password, captcha}
    
    Note over Gateway: ç™½åå•è·¯å¾„ï¼Œè·³è¿‡è®¤è¯
    
    Gateway->>Auth: è½¬å‘ç™»å½•è¯·æ±‚
    
    Auth->>Redis: éªŒè¯éªŒè¯ç 
    Redis-->>Auth: éªŒè¯ç æ­£ç¡®
    
    Auth->>MySQL: æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯<br/>SELECT * FROM iam_user WHERE username=?
    MySQL-->>Auth: è¿”å›ç”¨æˆ·æ•°æ®
    
    Auth->>Auth: BCryptéªŒè¯å¯†ç <br/>passwordEncoder.matches()
    
    Auth->>Auth: ç”ŸæˆJWT Token<br/>åŒ…å«userId, username, tenantIdç­‰
    
    Auth->>Redis: å­˜å‚¨Tokenæ˜ å°„<br/>token -> userInfo
    
    Auth->>MySQL: è®°å½•ç™»å½•æ—¥å¿—<br/>INSERT INTO iam_login_log
    
    Auth-->>Gateway: è¿”å›Tokenå’Œç”¨æˆ·ä¿¡æ¯
    Gateway-->>Client: ç™»å½•æˆåŠŸ<br/>{accessToken, refreshToken, userInfo}
    
    Note over Client: ä¿å­˜Tokenåˆ°localStorage
```

**å…³é”®ä»£ç é€»è¾‘ï¼š**

1. **éªŒè¯ç æ ¡éªŒ**
```java
// AuthService.java
String cachedCaptcha = redisTemplate.opsForValue().get("captcha:" + captchaKey);
if (!captcha.equalsIgnoreCase(cachedCaptcha)) {
    throw new BusinessException(ResponseStatus.CAPTCHA_INCORRECT);
}
```

2. **å¯†ç éªŒè¯**
```java
// BCryptåŠ å¯†éªŒè¯
if (!passwordEncoder.matches(request.getPassword(), user.getPassword())) {
    throw new BusinessException(ResponseStatus.ACCOUNT_INCORRECT);
}
```

3. **JWTç”Ÿæˆ**
```java
// JwtUtil.java
String token = Jwts.builder()
    .setSubject(userId)
    .claim("username", username)
    .claim("tenantId", tenantId)
    .setIssuedAt(new Date())
    .setExpiration(new Date(System.currentTimeMillis() + expiration * 1000))
    .signWith(key, SignatureAlgorithm.HS512)
    .compact();
```

### 4.2 APIç½‘å…³è®¤è¯æµç¨‹

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Gateway as ç½‘å…³è¿‡æ»¤å™¨
    participant Auth as è®¤è¯æœåŠ¡
    participant Service as ä¸šåŠ¡æœåŠ¡
    
    Client->>Gateway: è¯·æ±‚ä¸šåŠ¡API<br/>Header: Authorization: Bearer <token>
    
    Gateway->>Gateway: æ£€æŸ¥ç™½åå•<br/>isWhiteListPath()
    
    alt ç™½åå•è·¯å¾„
        Gateway->>Service: ç›´æ¥è½¬å‘
    else éœ€è¦è®¤è¯
        Gateway->>Gateway: æå–Token<br/>authHeader.substring(7)
        
        Gateway->>Auth: GET /iam/v1/auth/validate<br/>Header: Authorization
        
        Auth->>Auth: éªŒè¯Tokenç­¾åå’Œæœ‰æ•ˆæœŸ
        
        Auth-->>Gateway: è¿”å›ç”¨æˆ·ä¸Šä¸‹æ–‡<br/>{userId, username, tenantId, valid: true}
        
        alt Tokenæœ‰æ•ˆ
            Gateway->>Gateway: æ·»åŠ ç”¨æˆ·ä¿¡æ¯åˆ°è¯·æ±‚å¤´<br/>X-User-Id, X-Username, X-Tenant-Id
            Gateway->>Service: è½¬å‘è¯·æ±‚
            Service-->>Gateway: ä¸šåŠ¡å“åº”
            Gateway-->>Client: è¿”å›å“åº”
        else Tokenæ— æ•ˆ
            Gateway-->>Client: 401 Unauthorized
        end
    end
```

**ReactiveAuthenticationFilter æ ¸å¿ƒé€»è¾‘ï¼š**

```java
public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
    String path = request.getPath().value();
    
    // 1. ç™½åå•æ£€æŸ¥
    if (isWhiteListPath(path)) {
        return chain.filter(exchange);
    }
    
    // 2. æå–Token
    String authHeader = request.getHeaders().getFirst("Authorization");
    if (authHeader == null || !authHeader.startsWith("Bearer ")) {
        return handleUnauthorized(response, "ç¼ºå°‘Authorizationå¤´");
    }
    
    // 3. è°ƒç”¨è®¤è¯æœåŠ¡éªŒè¯ï¼ˆå“åº”å¼ï¼‰
    return validateTokenReactive(authHeader)
        .flatMap(apiResult -> {
            UserContext userContext = apiResult.getData();
            
            // 4. å°†ç”¨æˆ·ä¿¡æ¯æ·»åŠ åˆ°è¯·æ±‚å¤´
            ServerHttpRequest modifiedRequest = request.mutate()
                .header("X-User-Id", userContext.getUserId())
                .header("X-Username", userContext.getUsername())
                .header("X-Tenant-Id", userContext.getTenantId())
                .build();
            
            // 5. ç»§ç»­è¿‡æ»¤å™¨é“¾
            return chain.filter(exchange.mutate().request(modifiedRequest).build());
        });
}
```

### 4.3 é™æµæ§åˆ¶æµç¨‹

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Gateway as é™æµè¿‡æ»¤å™¨
    participant Redis as Redis
    participant Service as ä¸šåŠ¡æœåŠ¡
    
    Client->>Gateway: å‘é€è¯·æ±‚
    
    Gateway->>Gateway: è·å–å®¢æˆ·ç«¯IP<br/>getClientIp()
    
    Gateway->>Gateway: ç¡®å®šé™æµé…ç½®<br/>æ ¹æ®è·¯å¾„åŒ¹é…è§„åˆ™
    
    Note over Gateway: æ»‘åŠ¨çª—å£ç®—æ³•<br/>Key: rate_limit:ip:192.168.1.100
    
    Gateway->>Redis: INCR rate_limit:ip:{ip}<br/>SET EX {window}
    
    Redis-->>Gateway: å½“å‰è®¡æ•°
    
    alt æœªè¶…è¿‡é™åˆ¶
        Gateway->>Redis: INCR rate_limit:path:{path}
        Redis-->>Gateway: è®¡æ•°
        
        Gateway->>Redis: INCR rate_limit:combined:{ip}:{path}
        Redis-->>Gateway: è®¡æ•°
        
        Gateway->>Service: è½¬å‘è¯·æ±‚
        Service-->>Client: æ­£å¸¸å“åº”
    else è¶…è¿‡é™åˆ¶
        Gateway-->>Client: 429 Too Many Requests<br/>X-RateLimit-Limit: 100<br/>X-RateLimit-Remaining: 0
    end
```

**é™æµé…ç½®ï¼š**
```yaml
intellihub:
  gateway:
    rate-limit:
      enabled: true
      algorithm: SLIDING_WINDOW
      default-limit:
        requests: 100  # æ¯åˆ†é’Ÿ100æ¬¡
        window: 60
      limits:
        "/api/auth/**":
          requests: 5    # ç™»å½•æ¥å£æ›´ä¸¥æ ¼
          window: 60
        "/api/search/**":
          requests: 200  # æœç´¢æ¥å£æ›´å®½æ¾
          window: 60
```

### 4.4 APIæ³¨å†Œä¸è°ƒç”¨æµç¨‹

#### 4.4.1 å¼€å‘è€…æ³¨å†ŒAPI

```mermaid
sequenceDiagram
    participant Dev as å†…éƒ¨å¼€å‘è€…
    participant Gateway as APIç½‘å…³
    participant API as APIå¹³å°æœåŠ¡
    participant MySQL as æ•°æ®åº“
    
    Dev->>Gateway: POST /api/v1/apis<br/>Header: Authorization: Bearer {token}<br/>Body: {name, path, backendUrl, method}
    
    Gateway->>Gateway: JWTè®¤è¯é€šè¿‡<br/>æå–ç§Ÿæˆ·IDã€ç”¨æˆ·ID
    
    Gateway->>Gateway: æ·»åŠ ç”¨æˆ·ä¿¡æ¯åˆ°è¯·æ±‚å¤´<br/>X-Tenant-Id, X-User-Id
    
    Gateway->>API: è½¬å‘åˆ›å»ºAPIè¯·æ±‚
    
    API->>API: å‚æ•°æ ¡éªŒ<br/>è·¯å¾„æ ¼å¼ã€æ–¹æ³•ã€åç«¯åœ°å€
    
    API->>MySQL: æ’å…¥APIè®°å½•<br/>INSERT INTO api_info
    
    MySQL-->>API: æ’å…¥æˆåŠŸ
    
    API-->>Gateway: è¿”å›APIä¿¡æ¯
    Gateway-->>Dev: åˆ›å»ºæˆåŠŸ
```

#### 4.4.2 å¤–éƒ¨è°ƒç”¨è€…è°ƒç”¨APIï¼ˆè§„åˆ’ä¸­ï¼‰

```mermaid
sequenceDiagram
    participant Caller as å¤–éƒ¨è°ƒç”¨è€…
    participant Gateway as å¼€æ”¾ç½‘å…³
    participant API as APIå¹³å°æœåŠ¡
    participant Backend as å¼€å‘è€…çš„åç«¯æœåŠ¡
    participant MySQL as æ•°æ®åº“
    participant Redis as Redis
    
    Note over Caller: æºå¸¦API Keyè°ƒç”¨
    
    Caller->>Gateway: GET /open/user/info?userId=123<br/>Header: X-Api-Key: {apiKey}<br/>Header: X-App-Secret: {appSecret}
    
    Gateway->>API: éªŒè¯API Key<br/>æŸ¥è¯¢åº”ç”¨ä¿¡æ¯
    
    API->>MySQL: SELECT * FROM app_info WHERE api_key=?
    MySQL-->>API: è¿”å›åº”ç”¨ä¿¡æ¯
    
    API->>API: éªŒè¯ç­¾å<br/>éªŒè¯æƒé™
    
    API->>MySQL: æŸ¥è¯¢APIè·¯ç”±ä¿¡æ¯<br/>SELECT * FROM api_info WHERE path='/open/user/info'
    MySQL-->>API: è¿”å›åç«¯åœ°å€<br/>http://192.168.1.100:8080/api/users/info
    
    Gateway->>Redis: æ£€æŸ¥é™æµ<br/>rate_limit:app:{appId}:{path}
    Redis-->>Gateway: å…è®¸é€šè¿‡
    
    Gateway->>Backend: è½¬å‘è¯·æ±‚<br/>GET http://192.168.1.100:8080/api/users/info?userId=123
    
    Backend-->>Gateway: è¿”å›ç”¨æˆ·ä¿¡æ¯
    
    Gateway->>MySQL: è®°å½•è°ƒç”¨æ—¥å¿—<br/>INSERT INTO api_call_log
    
    Gateway-->>Caller: è¿”å›å“åº”
```

### 4.5 å¤šç§Ÿæˆ·éš”ç¦»æµç¨‹

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Gateway as ç½‘å…³
    participant Service as ä¸šåŠ¡æœåŠ¡
    participant MySQL as æ•°æ®åº“
    
    Client->>Gateway: è¯·æ±‚<br/>Header: Authorization: Bearer {token}
    
    Gateway->>Gateway: è§£æToken<br/>æå–tenantId
    
    Gateway->>Service: è½¬å‘è¯·æ±‚<br/>Header: X-Tenant-Id: tenant001
    
    Service->>Service: TenantInterceptoræ‹¦æˆª<br/>è®¾ç½®TenantContext
    
    Service->>MySQL: æ‰§è¡ŒSQL<br/>è‡ªåŠ¨æ·»åŠ ç§Ÿæˆ·æ¡ä»¶<br/>WHERE tenant_id = 'tenant001'
    
    Note over Service,MySQL: MyBatis Plusæ‹¦æˆªå™¨<br/>è‡ªåŠ¨åœ¨æ‰€æœ‰SQLæ·»åŠ ç§Ÿæˆ·è¿‡æ»¤
    
    MySQL-->>Service: è¿”å›å½“å‰ç§Ÿæˆ·æ•°æ®
    
    Service->>Service: æ¸…é™¤TenantContext
    
    Service-->>Gateway: å“åº”
    Gateway-->>Client: å“åº”
```

---

## 5. å­˜åœ¨çš„é—®é¢˜ä¸é£é™©

### 5.1 æ¶æ„å±‚é¢

#### âŒ é—®é¢˜1ï¼šæœåŠ¡åˆ’åˆ†ä¸å¤Ÿæ¸…æ™°

**ç°è±¡ï¼š**
- `intelli-api-platform-service` ä¸ `intelli-auth-iam-service` å…±ç”¨åŒä¸€ä¸ªæ•°æ®åº“ï¼ˆ`intellihub_iam`ï¼‰
- è¿åå¾®æœåŠ¡ç‹¬ç«‹æ•°æ®åº“åŸåˆ™

**é£é™©ï¼š**
- æœåŠ¡é—´è€¦åˆä¸¥é‡
- æ— æ³•ç‹¬ç«‹æ‰©å±•
- æ•°æ®ä¸€è‡´æ€§éš¾ä»¥ä¿è¯

**å»ºè®®ï¼š**
```
ä¿®æ”¹å‰ï¼š
intelli-auth-iam-service    â”€â”
                             â”œâ”€â”€> intellihub_iam æ•°æ®åº“
intelli-api-platform-service â”€â”˜

ä¿®æ”¹åï¼š
intelli-auth-iam-service â”€â”€â”€â”€> intellihub_iam æ•°æ®åº“
intelli-api-platform-service â”€> intellihub_api æ•°æ®åº“
```

#### âŒ é—®é¢˜2ï¼šç¼ºå°‘æœåŠ¡é—´é€šä¿¡æœºåˆ¶

**ç°è±¡ï¼š**
- ç½‘å…³è°ƒç”¨è®¤è¯æœåŠ¡ä½¿ç”¨ WebClientï¼ˆHTTPï¼‰
- ç¼ºå°‘æœåŠ¡é™çº§å’Œç†”æ–­æœºåˆ¶

**é£é™©ï¼š**
- è®¤è¯æœåŠ¡æ•…éšœä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨
- ç¼ºå°‘å®¹é”™èƒ½åŠ›

**å»ºè®®ï¼š**
- å¼•å…¥ **Sentinel** è¿›è¡Œç†”æ–­é™çº§
- ä½¿ç”¨ **OpenFeign** æ›¿ä»£ WebClientï¼Œæ”¯æŒå£°æ˜å¼è°ƒç”¨
- å®ç°é™çº§ç­–ç•¥ï¼ˆè®¤è¯æœåŠ¡å¼‚å¸¸æ—¶çš„åº”æ€¥å¤„ç†ï¼‰

#### âŒ é—®é¢˜3ï¼šåˆ†å¸ƒå¼äº‹åŠ¡ç¼ºå¤±

**åœºæ™¯ï¼š**
- ç”¨æˆ·æ³¨å†Œéœ€è¦åŒæ—¶ï¼š
  1. åœ¨ `iam_user` è¡¨æ’å…¥ç”¨æˆ·
  2. åœ¨ `iam_user_role` è¡¨åˆ†é…é»˜è®¤è§’è‰²
  3. å‘é€æ¬¢è¿é‚®ä»¶

**é£é™©ï¼š**
- æ•°æ®ä¸ä¸€è‡´ï¼ˆç”¨æˆ·åˆ›å»ºæˆåŠŸä½†è§’è‰²åˆ†é…å¤±è´¥ï¼‰
- ç¼ºå°‘è¡¥å¿æœºåˆ¶

**å»ºè®®ï¼š**
- å¼•å…¥ **Seata** åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶
- æˆ–é‡‡ç”¨ **Saga** æ¨¡å¼å®ç°æœ€ç»ˆä¸€è‡´æ€§

### 5.2 å®‰å…¨å±‚é¢

#### âš ï¸ é—®é¢˜4ï¼šJWTå¯†é’¥ç¡¬ç¼–ç 

**ç°è±¡ï¼š**
```yaml
# application.yml
intellihub:
  auth:
    jwt:
      secret: intellihub-iam-jwt-secret-key-2024-this-is-a-very-long-secret-key...
```

**é£é™©ï¼š**
- å¯†é’¥æ³„éœ²é£é™©
- æ— æ³•åŠ¨æ€è½®æ¢å¯†é’¥

**å»ºè®®ï¼š**
- å°†å¯†é’¥å­˜å‚¨åˆ° **Nacosé…ç½®ä¸­å¿ƒ** æˆ– **Vault**
- å®šæœŸè½®æ¢å¯†é’¥
- æ”¯æŒå¤šå¯†é’¥éªŒè¯ï¼ˆå¹³æ»‘è¿‡æ¸¡ï¼‰

#### âš ï¸ é—®é¢˜5ï¼šç¼ºå°‘APIå¯†é’¥ç®¡ç†

**ç°è±¡ï¼š**
- å½“å‰åªæœ‰JWTè®¤è¯ï¼ˆç”¨äºç®¡ç†åå°ï¼‰
- ç¼ºå°‘å¼€æ”¾APIçš„API Keyè®¤è¯æœºåˆ¶

**é£é™©ï¼š**
- å¤–éƒ¨è°ƒç”¨è€…æ— æ³•å®‰å…¨è°ƒç”¨API

**å»ºè®®ï¼š**
- å®ç° **API Key + App Secret** è®¤è¯
- å®ç°ç­¾åéªŒè¯æœºåˆ¶ï¼ˆé˜²æ­¢é‡æ”¾æ”»å‡»ï¼‰
- å‚è€ƒé˜¿é‡Œäº‘APIç½‘å…³çš„è®¤è¯æ¨¡å¼

#### âš ï¸ é—®é¢˜6ï¼šç¼ºå°‘XSSå’ŒCSRFé˜²æŠ¤

**ç°è±¡ï¼š**
- æœªé…ç½®Spring Securityçš„CSRFä¿æŠ¤
- å“åº”å¤´ç¼ºå°‘å®‰å…¨é…ç½®

**å»ºè®®ï¼š**
```java
// SecurityConfig.java
http
    .headers()
        .contentSecurityPolicy("default-src 'self'")
        .and()
        .xssProtection()
        .and()
    .csrf()
        .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse());
```

### 5.3 æ€§èƒ½å±‚é¢

#### âš ï¸ é—®é¢˜7ï¼šç¼“å­˜ç­–ç•¥ä¸å®Œå–„

**ç°è±¡ï¼š**
- ç”¨æˆ·ä¿¡æ¯æ¯æ¬¡éƒ½æŸ¥è¯¢æ•°æ®åº“
- APIè·¯ç”±ä¿¡æ¯æœªç¼“å­˜

**å½±å“ï¼š**
- æ•°æ®åº“å‹åŠ›å¤§
- å“åº”æ—¶é—´é•¿

**å»ºè®®ï¼š**
```java
// ä½¿ç”¨Redisç¼“å­˜ç”¨æˆ·ä¿¡æ¯
@Cacheable(value = "user", key = "#userId")
public IamUser getUserById(String userId) {
    return userMapper.selectById(userId);
}

// ç¼“å­˜APIè·¯ç”±
@Cacheable(value = "api_route", key = "#path")
public ApiInfo getApiByPath(String path) {
    return apiMapper.selectByPath(path);
}
```

#### âš ï¸ é—®é¢˜8ï¼šæ•°æ®åº“ç´¢å¼•ç¼ºå¤±

**é£é™©å­—æ®µï¼š**
- `iam_user.username`ï¼ˆç™»å½•æŸ¥è¯¢ï¼‰
- `iam_user.email`ï¼ˆé‚®ç®±ç™»å½•ï¼‰
- `api_info.path`ï¼ˆè·¯ç”±æŸ¥è¯¢ï¼‰
- `iam_login_log.user_id`ï¼ˆæ—¥å¿—æŸ¥è¯¢ï¼‰

**å»ºè®®ï¼š**
```sql
CREATE INDEX idx_username ON iam_user(username);
CREATE INDEX idx_email ON iam_user(email);
CREATE INDEX idx_path ON api_info(path);
CREATE INDEX idx_user_id ON iam_login_log(user_id);
```

#### âš ï¸ é—®é¢˜9ï¼šé™æµç®—æ³•å¯èƒ½å­˜åœ¨æ€§èƒ½ç“¶é¢ˆ

**ç°è±¡ï¼š**
- æ¯ä¸ªè¯·æ±‚éœ€è¦3æ¬¡Redisæ“ä½œï¼ˆIPã€Pathã€Combinedï¼‰
- é«˜å¹¶å‘ä¸‹Rediså‹åŠ›å¤§

**å»ºè®®ï¼š**
- ä½¿ç”¨ **Luaè„šæœ¬** åŸå­åŒ–æ‰§è¡Œ
- ä½¿ç”¨ **Redisç®¡é“** æ‰¹é‡æ“ä½œ
- è€ƒè™‘ä½¿ç”¨ **æœ¬åœ°é™æµ + åˆ†å¸ƒå¼é™æµ** ç»„åˆ

### 5.4 è¿ç»´å±‚é¢

#### âŒ é—®é¢˜10ï¼šç¼ºå°‘ç›‘æ§å’Œé“¾è·¯è¿½è¸ª

**ç¼ºå¤±èƒ½åŠ›ï¼š**
- æ— åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªï¼ˆå¦‚Sleuth + Zipkinï¼‰
- æ— æœåŠ¡ç›‘æ§ï¼ˆå¦‚Prometheus + Grafanaï¼‰
- æ— æ—¥å¿—èšåˆï¼ˆå¦‚ELKï¼‰

**å½±å“ï¼š**
- é—®é¢˜æ’æŸ¥å›°éš¾
- æ— æ³•å®šä½æ€§èƒ½ç“¶é¢ˆ

**å»ºè®®ï¼š**
```xml
<!-- å¼•å…¥Sleuth + Zipkin -->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-sleuth</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-sleuth-zipkin</artifactId>
</dependency>
```

#### âš ï¸ é—®é¢˜11ï¼šæ—¥å¿—ç®¡ç†æ··ä¹±

**ç°è±¡ï¼š**
- éƒ¨åˆ†æœåŠ¡æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°
- ç¼ºå°‘ç»Ÿä¸€æ—¥å¿—æ ¼å¼
- ç¼ºå°‘æ—¥å¿—çº§åˆ«æ§åˆ¶

**å»ºè®®ï¼š**
```yaml
# application.yml
logging:
  level:
    root: INFO
    com.intellihub: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/${spring.application.name}.log
    max-size: 100MB
    max-history: 30
```

#### âŒ é—®é¢˜12ï¼šç¼ºå°‘å¥åº·æ£€æŸ¥

**ç°è±¡ï¼š**
- éƒ¨åˆ†æœåŠ¡æœªé…ç½® `/actuator/health`
- æ— æ³•å®ç°è‡ªåŠ¨é‡å¯

**å»ºè®®ï¼š**
```yaml
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always
  health:
    redis:
      enabled: true
    db:
      enabled: true
```

### 5.5 ä»£ç è´¨é‡å±‚é¢

#### âš ï¸ é—®é¢˜13ï¼šå¼‚å¸¸å¤„ç†ä¸ç»Ÿä¸€

**ç°è±¡ï¼š**
```java
// éƒ¨åˆ†åœ°æ–¹æŠ›å‡ºRuntimeException
throw new RuntimeException("ç”¨æˆ·ä¸å­˜åœ¨");

// éƒ¨åˆ†åœ°æ–¹æŠ›å‡ºBusinessException
throw new BusinessException(ResponseStatus.USER_NOT_FOUND);
```

**å»ºè®®ï¼š**
- ç»Ÿä¸€ä½¿ç”¨ `BusinessException`
- å®Œå–„ `GlobalExceptionHandler`

#### âš ï¸ é—®é¢˜14ï¼šå‚æ•°æ ¡éªŒä¸å®Œæ•´

**ç°è±¡ï¼š**
- éƒ¨åˆ†Controllerç¼ºå°‘ `@Valid` æ³¨è§£
- DTOç¼ºå°‘æ ¡éªŒæ³¨è§£ï¼ˆ`@NotNull`ã€`@Size`ç­‰ï¼‰

**å»ºè®®ï¼š**
```java
// DTOå®šä¹‰
public class CreateApiRequest {
    @NotBlank(message = "APIåç§°ä¸èƒ½ä¸ºç©º")
    @Size(max = 100, message = "APIåç§°é•¿åº¦ä¸èƒ½è¶…è¿‡100")
    private String name;
    
    @NotBlank(message = "APIè·¯å¾„ä¸èƒ½ä¸ºç©º")
    @Pattern(regexp = "^/.*", message = "è·¯å¾„å¿…é¡»ä»¥/å¼€å¤´")
    private String path;
}

// Controller
@PostMapping
public ApiResponse<ApiInfoResponse> createApi(@Valid @RequestBody CreateApiRequest request) {
    // ...
}
```

#### âš ï¸ é—®é¢˜15ï¼šéƒ¨åˆ†æœåŠ¡å®ç°ç¼ºå¤±

**ç°è±¡ï¼š**
```java
// PermissionService.java
public interface PermissionService {
    // æ¥å£å®šä¹‰ä¸ºç©ºæ–‡ä»¶
}
```

**é£é™©ï¼š**
- æƒé™æ§åˆ¶åŠŸèƒ½æœªå®ç°
- æ— æ³•è¿›è¡Œç»†ç²’åº¦æƒé™ç®¡ç†

---

## 6. ä¼˜åŒ–å»ºè®®

### 6.1 çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰

#### 1ï¸âƒ£ å®Œå–„æ ¸å¿ƒåŠŸèƒ½
- [ ] å®ç° `PermissionService` æƒé™æœåŠ¡
- [ ] è¡¥å……APIå¹³å°æœåŠ¡çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- [ ] å®Œå–„å‚æ•°æ ¡éªŒå’Œå¼‚å¸¸å¤„ç†

#### 2ï¸âƒ£ åŠ å¼ºå®‰å…¨æ€§
- [ ] å°†JWTå¯†é’¥è¿ç§»åˆ°Nacosé…ç½®ä¸­å¿ƒ
- [ ] å®ç°API Keyè®¤è¯æœºåˆ¶
- [ ] æ·»åŠ è¯·æ±‚ç­¾åéªŒè¯

#### 3ï¸âƒ£ æ€§èƒ½ä¼˜åŒ–
- [ ] æ·»åŠ æ•°æ®åº“ç´¢å¼•
- [ ] å¼•å…¥Redisç¼“å­˜ç”¨æˆ·ä¿¡æ¯
- [ ] ä¼˜åŒ–é™æµé€»è¾‘ï¼ˆä½¿ç”¨Luaè„šæœ¬ï¼‰

### 6.2 ä¸­æœŸä¼˜åŒ–ï¼ˆ1ä¸ªæœˆï¼‰

#### 1ï¸âƒ£ æ¶æ„æ”¹è¿›
- [ ] æ•°æ®åº“æ‹†åˆ†ï¼ˆAPIå¹³å°ç‹¬ç«‹æ•°æ®åº“ï¼‰
- [ ] å¼•å…¥ Sentinel å®ç°ç†”æ–­é™çº§
- [ ] ä½¿ç”¨ OpenFeign æ›¿ä»£ WebClient

#### 2ï¸âƒ£ å¯è§‚æµ‹æ€§
- [ ] é›†æˆ Sleuth + Zipkin é“¾è·¯è¿½è¸ª
- [ ] é…ç½® Prometheus + Grafana ç›‘æ§
- [ ] ç»Ÿä¸€æ—¥å¿—æ ¼å¼å’Œè¾“å‡º

#### 3ï¸âƒ£ å¼€æ”¾APIç½‘å…³
- [ ] å®ç° OpenApiAuthenticationFilter
- [ ] å¼€å‘åº”ç”¨ç®¡ç†æ¨¡å—ï¼ˆAppId/AppSecretï¼‰
- [ ] å®ç°APIè°ƒç”¨è®¡è´¹ç»Ÿè®¡

### 6.3 é•¿æœŸè§„åˆ’ï¼ˆ3ä¸ªæœˆï¼‰

#### 1ï¸âƒ£ å¹³å°èƒ½åŠ›å¢å¼º
- [ ] APIå¸‚åœºï¼ˆAPIå‘ç°ã€è®¢é˜…ï¼‰
- [ ] APIæµ‹è¯•å·¥å…·ï¼ˆåœ¨çº¿è°ƒè¯•ï¼‰
- [ ] APIæ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆï¼ˆSwaggeré›†æˆï¼‰

#### 2ï¸âƒ£ é«˜å¯ç”¨æ¶æ„
- [ ] å¼•å…¥ Seata åˆ†å¸ƒå¼äº‹åŠ¡
- [ ] å®ç°æœåŠ¡å¤šæ´»éƒ¨ç½²
- [ ] æ•°æ®åº“è¯»å†™åˆ†ç¦»

#### 3ï¸âƒ£ æ™ºèƒ½åŒ–èƒ½åŠ›
- [ ] åŸºäºAIGCçš„APIæ¨è
- [ ] æ™ºèƒ½APIæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ
- [ ] å¼‚å¸¸æµé‡æ£€æµ‹ä¸å‘Šè­¦

---

## 7. æŠ€æœ¯å€ºåŠ¡æ¸…å•

| ä¼˜å…ˆçº§ | é—®é¢˜æè¿° | å½±å“èŒƒå›´ | é¢„ä¼°å·¥æ—¶ |
|-------|---------|---------|---------|
| ğŸ”´ P0 | æ•°æ®åº“å…±ç”¨å¯¼è‡´æœåŠ¡è€¦åˆ | æ¶æ„ | 3å¤© |
| ğŸ”´ P0 | ç¼ºå°‘æœåŠ¡ç†”æ–­é™çº§ | ç¨³å®šæ€§ | 2å¤© |
| ğŸ”´ P0 | JWTå¯†é’¥ç¡¬ç¼–ç  | å®‰å…¨ | 1å¤© |
| ğŸŸ  P1 | ç¼ºå°‘API Keyè®¤è¯ | åŠŸèƒ½ | 5å¤© |
| ğŸŸ  P1 | ç¼ºå°‘åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª | è¿ç»´ | 2å¤© |
| ğŸŸ  P1 | ç¼ºå°‘ç¼“å­˜ç­–ç•¥ | æ€§èƒ½ | 3å¤© |
| ğŸŸ¡ P2 | å¼‚å¸¸å¤„ç†ä¸ç»Ÿä¸€ | ä»£ç è´¨é‡ | 2å¤© |
| ğŸŸ¡ P2 | æ•°æ®åº“ç´¢å¼•ç¼ºå¤± | æ€§èƒ½ | 1å¤© |
| ğŸŸ¢ P3 | æ—¥å¿—ç®¡ç†æ··ä¹± | è¿ç»´ | 1å¤© |

---

## 8. æ€»ç»“

### 8.1 é¡¹ç›®äº®ç‚¹

âœ… **æ¶æ„è®¾è®¡åˆç†**
- é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼ŒæœåŠ¡èŒè´£æ¸…æ™°
- ä½¿ç”¨Spring Cloudå…¨å®¶æ¡¶ï¼ŒæŠ€æœ¯æ ˆæˆç†Ÿç¨³å®š

âœ… **å®‰å…¨æœºåˆ¶å®Œå–„**
- JWTè®¤è¯ + BCryptå¯†ç åŠ å¯†
- å¤šç§Ÿæˆ·éš”ç¦»
- é™æµæ§åˆ¶

âœ… **æ‰©å±•æ€§å¥½**
- åŸºäºNacosçš„æœåŠ¡æ³¨å†Œå‘ç°
- ç½‘å…³ç»Ÿä¸€æµé‡å…¥å£
- æ”¯æŒæ°´å¹³æ‰©å±•

### 8.2 å…³é”®é£é™©

âš ï¸ **æœåŠ¡é—´è€¦åˆä¸¥é‡**
- å…±ç”¨æ•°æ®åº“
- ç¼ºå°‘ç†”æ–­é™çº§

âš ï¸ **å¯è§‚æµ‹æ€§ä¸è¶³**
- æ— é“¾è·¯è¿½è¸ª
- ç›‘æ§ç¼ºå¤±

âš ï¸ **å®‰å…¨æ€§å¾…åŠ å¼º**
- å¯†é’¥ç®¡ç†ä¸å½“
- ç¼ºå°‘API Keyè®¤è¯

### 8.3 ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³è¡ŒåŠ¨**ï¼šä¿®å¤P0çº§åˆ«é—®é¢˜ï¼ˆæ•°æ®åº“æ‹†åˆ†ã€ç†”æ–­é™çº§ã€å¯†é’¥ç®¡ç†ï¼‰
2. **è¿‘æœŸè®¡åˆ’**ï¼šå®Œå–„æ ¸å¿ƒåŠŸèƒ½ï¼ˆAPI Keyè®¤è¯ã€é“¾è·¯è¿½è¸ªã€ç¼“å­˜ï¼‰
3. **é•¿æœŸè§„åˆ’**ï¼šå¢å¼ºå¹³å°èƒ½åŠ›ï¼ˆAPIå¸‚åœºã€æ™ºèƒ½æ¨èï¼‰

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**ï¼š2024å¹´12æœˆ22æ—¥  
**åˆ†æå¯¹è±¡**ï¼šIntelliHub v1.0.0-SNAPSHOT  
**åˆ†æäººå‘˜**ï¼šQoder AI
